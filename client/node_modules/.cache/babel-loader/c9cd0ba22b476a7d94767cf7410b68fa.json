{"ast":null,"code":"'use strict';\n\nvar uuidv4 = require('uuid/v4');\n\nvar TransactionQueries = {\n  /**\n   * Returns a query that sets the transaction isolation level.\n   *\n   * @param  {string} value   The isolation level.\n   * @param  {Object} options An object with options.\n   * @returns {string}         The generated sql query.\n   * @private\n   */\n  setIsolationLevelQuery: function setIsolationLevelQuery(value, options) {\n    if (options.parent) {\n      return;\n    }\n\n    return \"SET TRANSACTION ISOLATION LEVEL \".concat(value, \";\");\n  },\n  generateTransactionId: function generateTransactionId() {\n    return uuidv4();\n  },\n\n  /**\n   * Returns a query that starts a transaction.\n   *\n   * @param  {Transaction} transaction\n   * @returns {string}         The generated sql query.\n   * @private\n   */\n  startTransactionQuery: function startTransactionQuery(transaction) {\n    if (transaction.parent) {\n      // force quoting of savepoint identifiers for postgres\n      return \"SAVEPOINT \".concat(this.quoteIdentifier(transaction.name, true), \";\");\n    }\n\n    return 'START TRANSACTION;';\n  },\n  deferConstraintsQuery: function deferConstraintsQuery() {},\n  setConstraintQuery: function setConstraintQuery() {},\n  setDeferredQuery: function setDeferredQuery() {},\n  setImmediateQuery: function setImmediateQuery() {},\n\n  /**\n   * Returns a query that commits a transaction.\n   *\n   * @param  {Transaction} transaction An object with options.\n   * @returns {string}         The generated sql query.\n   * @private\n   */\n  commitTransactionQuery: function commitTransactionQuery(transaction) {\n    if (transaction.parent) {\n      return;\n    }\n\n    return 'COMMIT;';\n  },\n\n  /**\n   * Returns a query that rollbacks a transaction.\n   *\n   * @param  {Transaction} transaction\n   * @returns {string}         The generated sql query.\n   * @private\n   */\n  rollbackTransactionQuery: function rollbackTransactionQuery(transaction) {\n    if (transaction.parent) {\n      // force quoting of savepoint identifiers for postgres\n      return \"ROLLBACK TO SAVEPOINT \".concat(this.quoteIdentifier(transaction.name, true), \";\");\n    }\n\n    return 'ROLLBACK;';\n  }\n};\nmodule.exports = TransactionQueries;","map":null,"metadata":{},"sourceType":"script"}