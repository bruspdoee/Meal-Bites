{"ast":null,"code":"'use strict';\n\nvar fs = require('graceful-fs');\n\nvar mkdirp = require('fs-mkdirp-stream/mkdirp');\n\nvar fo = require('../../file-operations');\n\nfunction writeDir(file, optResolver, onWritten) {\n  mkdirp(file.path, file.stat.mode, onMkdirp);\n\n  function onMkdirp(mkdirpErr) {\n    if (mkdirpErr) {\n      return onWritten(mkdirpErr);\n    }\n\n    fs.open(file.path, 'r', onOpen);\n  }\n\n  function onOpen(openErr, fd) {\n    // If we don't have access, just move along\n    if (isInaccessible(openErr)) {\n      return fo.closeFd(null, fd, onWritten);\n    }\n\n    if (openErr) {\n      return fo.closeFd(openErr, fd, onWritten);\n    }\n\n    fo.updateMetadata(fd, file, onUpdate);\n\n    function onUpdate(updateErr) {\n      fo.closeFd(updateErr, fd, onWritten);\n    }\n  }\n}\n\nfunction isInaccessible(err) {\n  if (!err) {\n    return false;\n  }\n\n  if (err.code === 'EACCES') {\n    return true;\n  }\n\n  return false;\n}\n\nmodule.exports = writeDir;","map":null,"metadata":{},"sourceType":"script"}