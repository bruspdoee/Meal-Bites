{"ast":null,"code":"'use strict'; //const PLUGIN_NAME = 'mysql_native_password';\n\nvar auth41 = require('../auth_41.js');\n\nmodule.exports = function (pluginOptions) {\n  return function (_ref) {\n    var connection = _ref.connection,\n        command = _ref.command;\n    var password = command.password || pluginOptions.password || connection.config.password;\n    var passwordSha1 = command.passwordSha1 || pluginOptions.passwordSha1 || connection.config.passwordSha1;\n    return function (data) {\n      var authPluginData1 = data.slice(0, 8);\n      var authPluginData2 = data.slice(8, 20);\n      var authToken;\n\n      if (passwordSha1) {\n        authToken = auth41.calculateTokenFromPasswordSha(passwordSha1, authPluginData1, authPluginData2);\n      } else {\n        authToken = auth41.calculateToken(password, authPluginData1, authPluginData2);\n      }\n\n      return authToken;\n    };\n  };\n};","map":null,"metadata":{},"sourceType":"script"}